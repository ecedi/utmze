/**
 * jquery-utmz.js
 * @version 1.0.0
 * @build 2014-10-09 
 * @copyright (c) 2014 Agence Ecedi http://ecedi.fr
 * @author Sylvain Gogel <sgogel@ecedi.fr>
 * @licence MIT
 */
"use strict";!function(a){a.fn.utmz=function(){var b=function(a){a=a.split("+").join(" ");for(var b,c={},d=/[?&]?([^=]+)=([^&]*)/g;b=d.exec(a);)c[decodeURIComponent(b[1])]=decodeURIComponent(b[2]);return c},c=function(a){var b,c,d,e=document.createElement("a"),f={};for(e.href=a,b=e.search.replace(/^\?/,"").split("&"),d=0;d<b.length;d++)c=b[d].split("="),f[c[0]]=c[1];return{protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search,searchObject:f,hash:e.hash}},d=function(a){var b=a.split(".");if(b.length<=2)return[a];var c=[],d=b.length-1,e="";for(d;d>=0;d--)e="."+b[d]+e,c.push(e);return c.shift(),c},e=function(a){var b=function(a){var b,c,d=1,e=0;if(a)for(d=0,b=a.length-1;b>=0;b--)c=a.charCodeAt(b),d=(d<<6&268435455)+c+(c<<14),e=266338304&d,d=0!==e?d^e>>21:d;return d},c=Date.now(),d=6,e=1,f="";return f="utmcsr="+a.utmcsr+"|utmccn="+a.utmccn+"|utmcmd="+a.utmcmd,b(document.domain)+"."+c+"."+d+"."+e+"."+f},f=function(a){for(var b=a.split(".").slice(4).join(".").split("|"),c={},d=0;d<b.length;d++){var e=b[d].split("=");c[e[0]]=e[1]}return c},g=function(b,c){var d=e(b);a(c).each(function(b,c){return a.cookie.raw=!0,a.cookie("__utmze",d,{expires:182,domain:c})})},h={utmcsr:!1,utmccn:!1,utmcmd:!1};a.cookie("__utmze")&&(h=f(a.cookie("__utmze"))),console.log("read cookie"),console.log(h);var i=b(document.location.search),j={utmcsr:h.utmcsr||!1,utmccn:h.utmccn||!1,utmcmd:h.utmcmd||!1},k=c(document.domain).hostname;if(i.hasOwnProperty("utm_source"))j.utmcsr=i.utm_source;else{var l=c(document.referrer).hostname;console.log("referrer domain: "+l),console.log("current  domain: "+k),j.utmcsr=l===k?h.utmcsr||!1:l,""===j.utmcsr&&(j.utmcsr="(direct)"),j.utmcsr===!1&&(j.utmcsr="(organic)")}i.hasOwnProperty("utm_campaign")&&(j.utmccn=i.utm_campaign),i.hasOwnProperty("utm_medium")&&(j.utmcmd=i.utm_medium),console.log(j);var m=d(k);return g(j,m),this}}(jQuery);